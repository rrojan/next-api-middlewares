{"version":3,"sources":["../src/helpers.ts","../src/index.ts"],"sourcesContent":["import { NextRequest } from \"next/server\"\nimport { MiddlewareChain, NextFn, Params } from \"./types\"\n\nexport const startPipe = async (\n  req: NextRequest,\n  params: Params,\n  fns: MiddlewareChain,\n  currentFnIndex: number\n) => {\n  const next: NextFn = async (pipeParams: any) => {\n    // Recursively run next pipe fn until the end of the chain\n    const nextPipeFunction = fns[currentFnIndex + 1]\n    if (!nextPipeFunction) return\n\n    return await startPipe(\n      req,\n      { ...params, pipeParams },\n      fns,\n      currentFnIndex + 1\n    )\n  }\n\n  // The next function will recursively run next function from list of pipe functions\n  return await fns[currentFnIndex](req, params, next)\n}\n","import { NextRequest } from \"next/server\"\nimport { MiddlewareChain, Params } from \"./types\"\nimport { startPipe } from \"./helpers\"\n\nconst pipe = async (...fns: MiddlewareChain) => {\n  return async (req: NextRequest, params: Params) => {\n    return await startPipe(req, params, fns, 0)\n  }\n}\n\nconst pipeWithErrorInterceptor = async (...fns: MiddlewareChain) => {\n  const errorInterceptor = fns[fns.length - 1]\n  try {\n    return pipe(...fns.slice(0, fns.length - 1))\n  } catch (e) {\n    errorInterceptor(e)\n  }\n}\n\nexport { pipe, pipeWithErrorInterceptor }\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGO,IAAM,YAAY,CACvB,KACA,QACA,KACA,mBACG;AACH,QAAM,OAAe,CAAO,eAAoB;AAE9C,UAAM,mBAAmB,IAAI,iBAAiB,CAAC;AAC/C,QAAI,CAAC;AAAkB;AAEvB,WAAO,MAAM;AAAA,MACX;AAAA,MACA,iCAAK,SAAL,EAAa,WAAW;AAAA,MACxB;AAAA,MACA,iBAAiB;AAAA,IACnB;AAAA,EACF;AAGA,SAAO,MAAM,IAAI,cAAc,EAAE,KAAK,QAAQ,IAAI;AACpD;;;ACpBA,IAAM,OAAO,IAAU,QAAyB;AAC9C,SAAO,CAAO,KAAkB,WAAmB;AACjD,WAAO,MAAM,UAAU,KAAK,QAAQ,KAAK,CAAC;AAAA,EAC5C;AACF;AAEA,IAAM,2BAA2B,IAAU,QAAyB;AAClE,QAAM,mBAAmB,IAAI,IAAI,SAAS,CAAC;AAC3C,MAAI;AACF,WAAO,KAAK,GAAG,IAAI,MAAM,GAAG,IAAI,SAAS,CAAC,CAAC;AAAA,EAC7C,SAAS,GAAG;AACV,qBAAiB,CAAC;AAAA,EACpB;AACF;","names":[]}