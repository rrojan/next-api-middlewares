{"version":3,"sources":["../src/index.ts","../src/helpers.ts"],"sourcesContent":["import { NextRequest } from \"next/server\"\nimport { MiddlewareChain, Params } from \"./types\"\nimport { startPipe } from \"./helpers\"\n\nconst pipe = async (...fns: any) => {\n  return async (req: NextRequest, params: any) => {\n    return await startPipe(req, params, fns, 0)\n  }\n}\n\n// const pipeWithErrorInterceptor = async (...fns: MiddlewareChain) => {\n//   const errorInterceptor = fns[fns.length - 1]\n//   try {\n//     return pipe(...fns.slice(0, fns.length - 1))\n//   } catch (e) {\n//     errorInterceptor(e)\n//   }\n// }\n\nexport { pipe }\n","import { NextRequest } from \"next/server\"\nimport { MiddlewareChain, NextFn, Params } from \"./types\"\n\nexport const startPipe = async (\n  req: NextRequest,\n  params: any,\n  fns: any[],\n  currentFnIndex: number\n) => {\n  const next: any = async (pipeParams: any) => {\n    // Recursively run next pipe fn until the end of the chain\n    const nextPipeFunction = fns[currentFnIndex + 1]\n    if (!nextPipeFunction) return\n\n    return await startPipe(\n      req,\n      { ...params, pipeParams },\n      fns,\n      currentFnIndex + 1\n    )\n  }\n\n  // The next function will recursively run next function from list of pipe functions\n  return await fns[currentFnIndex](req, params, next)\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACGO,IAAM,YAAY,CACvB,KACA,QACA,KACA,mBACG;AACH,QAAM,OAAY,CAAO,eAAoB;AAE3C,UAAM,mBAAmB,IAAI,iBAAiB,CAAC;AAC/C,QAAI,CAAC;AAAkB;AAEvB,WAAO,MAAM;AAAA,MACX;AAAA,MACA,iCAAK,SAAL,EAAa,WAAW;AAAA,MACxB;AAAA,MACA,iBAAiB;AAAA,IACnB;AAAA,EACF;AAGA,SAAO,MAAM,IAAI,cAAc,EAAE,KAAK,QAAQ,IAAI;AACpD;;;ADpBA,IAAM,OAAO,IAAU,QAAa;AAClC,SAAO,CAAO,KAAkB,WAAgB;AAC9C,WAAO,MAAM,UAAU,KAAK,QAAQ,KAAK,CAAC;AAAA,EAC5C;AACF;","names":[]}